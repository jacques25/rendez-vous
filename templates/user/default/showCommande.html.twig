{% extends 'base.html.twig' %}

		
		{% set port = 0 %}
		{% set  totalBijou = 0 %}
		{% set totalPromo = 0 %}
		{% block body %}
     
			
			<div class="row flex-row mt-5">


				<div class="col-3">
					<h1>Commande  </h1>
					<p class=""><strong>Commandé le : </strong><em>		{{commande.dateCommande|format_datetime('full', 'none', locale='fr')|capitalize }}</em>		</p>
					<p class=""><strong> Commande n° : </strong><em>	{{ commande.numeroCommande }}</em>	</p>
				</div>
				<div class="col-3 center mt-5">
					<h3>
						Adresse livraison
					</h3>

					<p class="">
					  {{app.user.gender}}
						{{commande.commande.livraison.lastname }}
						{{commande.commande.livraison.firstname }}
					</p>
					<p class="">

						{{commande.commande.livraison.address }}
					</p>
					<p class="">
						{{commande.commande.livraison.cp }}

						{{commande.commande.livraison.city }}
						{{commande.commande.livraison.country }}
					</p>


				</div>
						<div class="col-3 center mt-5">
					<h3>
						Adresse facturation
					</h3>

					<p class="">
					{{app.user.gender }}
						{{commande.commande.facturation.lastname }}
						{{commande.commande.facturation.firstname }}
					</p>
					<p class="">

						{{commande.commande.facturation.address }}
					</p>
					<p class="">
						{{commande.commande.facturation.cp }}

						{{commande.commande.facturation.city }}
						{{commande.commande.facturation.country }}
					</p>


				</div>
			</div>

			<div class="row">

				{% if commande.commande.optionBijou is defined and commande.commande.optionBijou is not null %}
       
					<table class="table-fluid">


						<thead class="table-thead">
							<tr>
								<th>
								 {{'Référence'}}
								</th>
								<th>
									Quantité
								</th>
									
									<th>	Taille</th>
								
								
							
								
								<th>
									P.U
								</th>
								<th>
								Sous total
								</th>
							</tr>
						</thead>
						<tbody class="table-tbody">
							{% for option in commande.commande.optionBijou  %}
							 
									<tr>
	             {#   <td><img src="{{vich_uploader_asset(option.bijou,'imageFile')}}" width="40"></td>  #}
									<td>	{{ option.reference }}	</td>
								
									<td>{{ option.quantite }}</td>
									<td>	{{option.taille}}</td>
									 {% if option.bijou.promoIsActive == true %}
									          <td> {{ option.bijou.labelPromo}} - {{(option.prix * option.bijou.multiplicate)|number_format(2)}}</td>
								
								    <td> {{((option.prix * option.bijou.multiplicate) * option.quantite)|number_format(2)}}</td>
									 {% else %}
										 <td>	{{ option.prix|number_format(2) }}</td>
										 	<td>
										{{(option.prix * option.quantite)|number_format(2)}}
									</td>
									 {% endif %}
									
                
								
									</tr>
							{% endfor %}

						
						</tbody>
					    
					</table>
             
				{% endif %}
			</div>
	
				<div class="d-flex flex-row-reverse float-right">
					<div class="col-12 mx-4" id="total">
					{% for option in commande.commande.optionBijou %}
					{% if option.bijou.promoIsActive == true %}
						 {% set port = option.bijou.port %}
						 {% set totalPromo =  (option.prix * option.bijou.multiplicate) * option.quantite %}
						 {% else %}
							 	   {% set totalBijou =  option.prix * option.quantite  %}
					{% endif %}
					
						
						 
					{% endfor %}
					<div class="left">
					   <span>SOUS-TOTAL:</span> <span class="float-right">{{ (totalBijou + totalPromo)|number_format(2)}} €</span><br>
						  <span> PORT :  </span>          <span  class="float-right">  {{port|number_format(2)}} €</span><br>
							<span>TOTAL COMMANDE : </span> <span  class="ml-5 float-right">   	{{ (totalBijou + totalPromo+ port)|number_format(2)}} €	</span>
							</div>
				
					


				</div>
			 </div>
			
			<a class="btn btn-telechargement" href="{{ path('commande_pdf',{'id': commande.id}) }}" target="_blank">
										<i class="fas fa-upload"></i> {{'téléchargement du bon de commande'|upper }}
								  	</a>
			<div class="row mt-5">
				<div class="col-6">
					<a class="btn btn-primary" href="{{path('account_profile')}}">
						Retour
					</a>
				</div>
			</div>
      
		{% endblock %}
